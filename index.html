<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Meta information -->
  <meta name="Principal investigator (PI):" content="Danny Sungsoo Kim, MD, PhD">
  <meta name="Contributors (alphabetical order)" content="Daniel Cole, MD, Jonathan Ho, MD, Matt Fischer, MD, MS, 
    Maxime Cannesson, MD, PhD, Sohee Kwon, MD, MPH">  
  <meta name="description" content="Machine Learning Models for Predicting New-Onset Atrial Fibrillation 
    Following Coronary Artery Bypass Grafting (CABG).">
  
  <title>New-Onset Atrial Fibrillation after CABG</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    .meta-info {
      font-size: 14px;
      color: #555; /* Gray color for metadata */
      margin-bottom: 20px; /* Space below metadata */
    }
    .section {
      margin: 20px 0;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .demographic {
      background-color: #f0f8ff; /* Light blue background */
    }
    .medical-history {
      background-color: #f5f5dc; /* Light beige background */
    }
    .echo {
      background-color: #f0fff0; /* Light green background */
    }
    .physiology {
      background-color: #e6ffe6; /* Very light green background */
    }
    .result {
      background-color: #fff0f5; /* Light pink background */
    }
    .section h2 {
      margin-top: 0;
    }
    .question {
      margin-bottom: 15px;
    }
    button {
      padding: 10px 20px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }    
  </style>
</head>
<body>

  <form id="risk-form">
    <h1>New-Onset Atrial Fibrillation after CABG</h1>

    <!-- Displaying meta information -->
    <div class="meta-info">
      <p><strong>Description:</strong> Risk calculator for New-Onset Post-operative Atrial Fibrillation Following Coronary Artery Bypass Grafting (CABG)
        (based on Machine Learning Models, proposed by JornalName[Year]).</p>
      <p><strong>Principal investigator (PI):</strong> Danny Sungsoo Kim, MD, PhD (sungsoomd@gmail.com)</p>
      <p><strong>Contributors :</strong> (alphabetical order) Daniel Cole, MD, Jonathan Ho, MD, 
        Matt Fischer, MD, MS, Maxime Cannesson, MD, PhD</p>
      <p><strong>Date:</strong> <span id="currentDate"></span></p>
    </div>
    
    <!-- Demographic Section -->
    <div class="section demographic">
      <h2>Demographic</h2>
      <div class="question">
        <label>Gender: Male? (sex assigned at birth)</label><br>
        <input type="radio" name="Male" value=1 checked> Yes
        <input type="radio" name="Male" value=0> No
      </div>
  
      <div class="question">
        <label>Age (years old) at CABG?</label><br>
        <input type="radio" id="18_≤_Age_<_65" name="age" value=0 checked> 
        <label for="18_≤_Age_<_65">18 ≤ Age < 65 (0 points)</label><br>
  
        <input type="radio" id="65_≤_Age_<_75" name="age" value=1> 
        <label for="65_≤_Age_<_75">65 ≤ Age < 75 (1 point)</label><br>
  
        <input type="radio" id="75 ≤ Age" name="age" value=2> 
        <label for="75_≤_Age">75 ≤ Age (2 points)</label><br>
      </div>
    </div>
  
    <!-- Past Medical History Section -->
    <div class="section medical-history">
      <h2>Past Medical History</h2>
      
      <div class="question">
        <label>Past Medical History: Congestive heart failure (EF ≤ 40%)?</label><br>
        <input type="radio" name="Congestive_heart_failure" value="yes" checked> Yes
        <input type="radio" name="Congestive_heart_failure" value="no"> No
      </div>
      
      <div class="question">
        <label>Past Medical History: dyslipidemia?</label><br>
        <input type="radio" name="dysplipidemia" value="yes" checked> Yes
        <input type="radio" name="dysplipidemia" value="no"> No
      </div>
  
      <div class="question">
        <label>Past Medical History: hypertension?</label><br>
        <input type="radio" name="hypertension" value="yes" checked> Yes
        <input type="radio" name="hypertension" value="no"> No
      </div>
  
      <div class="question">
        <label>Past Medical History: valvular heart disease?</label><br>
        <input type="radio" name="valvular_heart_disease" value="yes" checked> Yes
        <input type="radio" name="valvular_heart_disease" value="no"> No
      </div>    
      
    </div>

    <!-- Echo Section -->
    <div class="section echo">
      <h2>Echo</h2>
      <div class="question">
        <label>Echo (TTE or TEE): atrial dilation? (LA volume > 50 cm<sup>3</sup>)?</label><br>
        <input type="radio" name="atrial_dilation" value="yes" checked> Yes
        <input type="radio" name="atrial_dilation" value="no"> No
        <input type="radio" name="atrial_dilation" value="unknown"> unknown
      </div>    
  
      <div class="question">
        <label>Echo (TTE or TEE): atrial hypertrophy?</label><br>
        <input type="radio" name="atrial_hypertrophy" value="yes" checked> Yes
        <input type="radio" name="atrial_hypertrophy" value="no"> No
        <input type="radio" name="atrial_hypertrophy" value="unknown"> unknown
      </div>    
    </div>
    
    <!-- Physiology Section -->
    <div class="section physiology">
      <h2>Physiology</h2>
  
      <div class="question">
        <label>Physiology: tachycardia (heart rate > 100)?</label><br>
        <input type="radio" name="tachycardia" value="yes" checked> Yes
        <input type="radio" name="tachycardia" value="no"> No
        <input type="radio" name="tachycardia" value="unknown"> unknown
      </div>    
  
      <div class="question">
        <label>Physiology: Heart rate variability?</label><br>
        <input type="radio" name="Heart_rate_variability" value="yes" checked> Yes
        <input type="radio" name="Heart_rate_variability" value="no"> No
        <input type="radio" name="Heart_rate_variability" value="unknown"> unknown
      </div>    
  
      <div class="question">
        <label>Physiology: Fever? (>100.4°F or >38°C) </label><br>
        <input type="radio" name="Fever" value="yes" checked> Yes
        <input type="radio" name="Fever" value="no"> No
        <input type="radio" name="Fever" value="unknown"> unknown
      </div>    
    </div>

    <!-- Result Section -->
    <div class="section result">
      <h2>Your Risk Score (ver. 20240925)</h2>
      <p>After completing the questionnaire, your results will be shown here with rationale.</p>
    </div>

    <button type="button" onclick="calculateRisk()">Calculate Risk</button>
  </form>

  <!-- Ensure this is linked correctly -->
  <script src="script.js"></script> 
  
  <script>
    // Function to allow de-selection of radio buttons
    document.querySelectorAll('input[type="radio"]').forEach((radio) => {
      radio.addEventListener('click', function () {
        if (this.previousChecked && this.previousChecked === this) {
          this.checked = false; // De-select if clicked again
        }
        this.previousChecked = this; // Store the currently checked radio
      });
    });

    function calculateRisk() {
      // Call the function defined in script.js
      if (typeof runRiskCalculation === "function") {
        runRiskCalculation(); // Call the function from script.js
      } else {
        alert('Risk calculation function not found in script.js.');
      }

      // Function to update the date
      function updateDate() {
          const today = new Date();
          const options = { year: 'numeric', month: 'long', day: 'numeric' };
          const formattedDate = today.toLocaleDateString('en-US', options);
          document.getElementById('currentDate').textContent = formattedDate;
      }
  
      // Call the function to update the date on page load
      window.onload = updateDate;
    }
  </script>

</body>
</html>
